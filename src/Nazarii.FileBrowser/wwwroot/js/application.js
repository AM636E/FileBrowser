var Nazarii;
(function (Nazarii) {
    var FileBrowser;
    (function (FileBrowser) {
        var Services;
        (function (Services) {
            var DefaultFileService = (function () {
                function DefaultFileService($http, $q) {
                    this.$http = $http;
                    this.$q = $q;
                }
                DefaultFileService.prototype.getDirectoryInfo = function (path) {
                    var d = this.$q.defer();
                    this.$http.get("api/file/info?path=" + path)
                        .then(function (a) { return d.resolve(a.data); }, function (e) { return d.reject(e); });
                    return d.promise;
                };
                DefaultFileService.prototype.getDirectory = function (path) {
                    var d = this.$q.defer();
                    this.$http.get("api/file/get?path=" + path)
                        .then(function (a) { return d.resolve(a.data); }, function (e) { return d.reject(e); });
                    return d.promise;
                };
                DefaultFileService.$inject = ["$http", "$q"];
                return DefaultFileService;
            })();
            Services.DefaultFileService = DefaultFileService;
        })(Services = FileBrowser.Services || (FileBrowser.Services = {}));
    })(FileBrowser = Nazarii.FileBrowser || (Nazarii.FileBrowser = {}));
})(Nazarii || (Nazarii = {}));

/// <reference path="../tstypings/angular.d.ts" />
/// <reference path="../services/fileservice.ts" />
var Nazarii;
(function (Nazarii) {
    var FileBrowser;
    (function (FileBrowser) {
        var Directives;
        (function (Directives) {
            function fileBrowserDirective($location, $timeout, fileService) {
                return {
                    restrict: "E",
                    templateUrl: "index.tpl.html",
                    link: function ($scope) {
                        var createReadablePath = function (path) {
                            var s = path.replace("/root/", "");
                            return (s.slice(0, 1).toUpperCase() + ":" + s.slice(1)).replace(/\//g, "\\");
                        };
                        $scope.$on("$locationChangeSuccess", function () {
                            $scope.update();
                        });
                        $scope.moveUp = function () {
                            var loc = $location.path().split("/");
                            // Remove two last characters from path.
                            loc.pop();
                            loc.pop();
                            $location.path(loc.join("/"));
                        };
                        var setError = function (e) {
                            $scope.error = e;
                            $timeout(function () { return $scope.error = null; }, 2000);
                        };
                        $scope.update = function () {
                            var path = $location.path() || "./";
                            $scope.directoryInfo = null;
                            fileService.getDirectory(path)
                                .then(function (a) {
                                $scope.directory = a;
                                $scope.readablePath = createReadablePath($scope.directory.fullPath);
                                $location.path($scope.directory.fullPath);
                            }, setError);
                            fileService.getDirectoryInfo(path)
                                .then(function (a) {
                                $scope.directoryInfo = a;
                                $scope.error = null;
                            }, setError);
                        };
                        $scope.update();
                    }
                };
            }
            Directives.fileBrowserDirective = fileBrowserDirective;
            fileBrowserDirective.$inject = ["$location", "$timeout", "FileService"];
        })(Directives = FileBrowser.Directives || (FileBrowser.Directives = {}));
    })(FileBrowser = Nazarii.FileBrowser || (Nazarii.FileBrowser = {}));
})(Nazarii || (Nazarii = {}));

(function (ng) {
    ng.module("nazarii.filebrowser", ["ngRoute", "angular-loading-bar"])
        .controller("empty", function () { })
        .directive("nazariiFileBrowser", Nazarii.FileBrowser.Directives.fileBrowserDirective)
        .service("FileService", Nazarii.FileBrowser.Services.DefaultFileService);
})(angular);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNlcnZpY2VzL0ZpbGVTZXJ2aWNlLnRzIiwiRGlyZWN0aXZlcy9GaWxlQnJvd3Nlci50cyIsImFwcC50cyJdLCJuYW1lcyI6WyJOYXphcmlpIiwiTmF6YXJpaS5GaWxlQnJvd3NlciIsIk5hemFyaWkuRmlsZUJyb3dzZXIuU2VydmljZXMiLCJOYXphcmlpLkZpbGVCcm93c2VyLlNlcnZpY2VzLkRlZmF1bHRGaWxlU2VydmljZSIsIk5hemFyaWkuRmlsZUJyb3dzZXIuU2VydmljZXMuRGVmYXVsdEZpbGVTZXJ2aWNlLmNvbnN0cnVjdG9yIiwiTmF6YXJpaS5GaWxlQnJvd3Nlci5TZXJ2aWNlcy5EZWZhdWx0RmlsZVNlcnZpY2UuZ2V0RGlyZWN0b3J5SW5mbyIsIk5hemFyaWkuRmlsZUJyb3dzZXIuU2VydmljZXMuRGVmYXVsdEZpbGVTZXJ2aWNlLmdldERpcmVjdG9yeSIsIk5hemFyaWkuRmlsZUJyb3dzZXIuRGlyZWN0aXZlcyIsIk5hemFyaWkuRmlsZUJyb3dzZXIuRGlyZWN0aXZlcy5maWxlQnJvd3NlckRpcmVjdGl2ZSIsIk5hemFyaWkuRmlsZUJyb3dzZXIuRGlyZWN0aXZlcy5maWxlQnJvd3NlckRpcmVjdGl2ZS5saW5rIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFPLE9BQU8sQ0EwQ2I7QUExQ0QsV0FBTyxPQUFPO0lBQUNBLElBQUFBLFdBQVdBLENBMEN6QkE7SUExQ2NBLFdBQUFBLFdBQVdBO1FBQUNDLElBQUFBLFFBQVFBLENBMENsQ0E7UUExQzBCQSxXQUFBQSxRQUFRQSxFQUFDQSxDQUFDQTtZQWlCakNDO2dCQUlJQyw0QkFBWUEsS0FBMkJBLEVBQUVBLEVBQXFCQTtvQkFDMURDLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLEtBQUtBLENBQUNBO29CQUNuQkEsSUFBSUEsQ0FBQ0EsRUFBRUEsR0FBR0EsRUFBRUEsQ0FBQ0E7Z0JBQ2pCQSxDQUFDQTtnQkFFREQsNkNBQWdCQSxHQUFoQkEsVUFBaUJBLElBQVlBO29CQUN6QkUsSUFBSUEsQ0FBQ0Es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Q0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNqRixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyIsImZpbGUiOiJhcHBsaWNhdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZSBOYXphcmlpLkZpbGVCcm93c2VyLlNlcnZpY2VzIHtcclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgSURpcmVjdG9yeUluZm8ge1xyXG4gICAgICAgIHNtYWxsRGlyZWN0b3JpZXM6IG51bWJlcjtcclxuICAgICAgICBtaWRkbGVEaXJlY3RvcmllczogbnVtYmVyO1xyXG4gICAgICAgIGxhcmdlRGlyZWN0b3JpZXM6IG51bWJlcjtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgaW50ZXJmYWNlIElEaXJlY3Rvcnkge1xyXG4gICAgICAgIG5hbWU6IHN0cmluZztcclxuICAgICAgICBjaGlsZHJlbj86IElEaXJlY3RvcnlbXTtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgaW50ZXJmYWNlIElGaWxlU2VydmljZSB7XHJcbiAgICAgICAgZ2V0RGlyZWN0b3J5SW5mbyhwYXRoOiBzdHJpbmcpOiBhbmd1bGFyLklQcm9taXNlPElEaXJlY3RvcnlJbmZvPjtcclxuICAgICAgICBnZXREaXJlY3RvcnkocGF0aDogc3RyaW5nKTogYW5ndWxhci5JUHJvbWlzZTxJRGlyZWN0b3J5PjtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgY2xhc3MgRGVmYXVsdEZpbGVTZXJ2aWNlIGltcGxlbWVudHMgSUZpbGVTZXJ2aWNlIHtcclxuICAgICAgICBwcml2YXRlICRodHRwOiBhbmd1bGFyLklIdHRwU2VydmljZTtcclxuICAgICAgICBwcml2YXRlICRxOiBhbmd1bGFyLklRU2VydmljZTtcclxuICAgICAgICBzdGF0aWMgJGluamVjdCA9IFtcIiRodHRwXCIsIFwiJHFcIl07XHJcbiAgICAgICAgY29uc3RydWN0b3IoJGh0dHA6IGFuZ3VsYXIuSUh0dHBTZXJ2aWNlLCAkcTogYW5ndWxhci5JUVNlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy4kaHR0cCA9ICRodHRwO1xyXG4gICAgICAgICAgICB0aGlzLiRxID0gJHE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBnZXREaXJlY3RvcnlJbmZvKHBhdGg6IHN0cmluZyk6IGFuZ3VsYXIuSVByb21pc2U8SURpcmVjdG9yeUluZm8+IHtcclxuICAgICAgICAgICAgdmFyIGQgPSB0aGlzLiRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuJGh0dHAuZ2V0PElEaXJlY3Rvcnk+KGBhcGkvZmlsZS9pbmZvP3BhdGg9JHtwYXRofWApXHJcbiAgICAgICAgICAgICAgICAudGhlbihhID0+IGQucmVzb2x2ZShhLmRhdGEpLCBlID0+IGQucmVqZWN0KGUpKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBnZXREaXJlY3RvcnkocGF0aDogc3RyaW5nKTogYW5ndWxhci5JUHJvbWlzZTxJRGlyZWN0b3J5PiB7XHJcbiAgICAgICAgICAgIHZhciBkID0gdGhpcy4kcS5kZWZlcigpO1xyXG4gICAgICAgICAgICB0aGlzLiRodHRwLmdldDxJRGlyZWN0b3J5PihgYXBpL2ZpbGUvZ2V0P3BhdGg9JHtwYXRofWApXHJcbiAgICAgICAgICAgICAgICAudGhlbihhID0+IGQucmVzb2x2ZShhLmRhdGEpLCBlID0+IGQucmVqZWN0KGUpKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3RzdHlwaW5ncy9hbmd1bGFyLmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vc2VydmljZXMvZmlsZXNlcnZpY2UudHNcIiAvPlxyXG5tb2R1bGUgTmF6YXJpaS5GaWxlQnJvd3Nlci5EaXJlY3RpdmVzIHtcclxuICAgIGltcG9ydCBGaWxlU2VydmljZSA9IE5hemFyaWkuRmlsZUJyb3dzZXIuU2VydmljZXMuSUZpbGVTZXJ2aWNlO1xyXG5cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBmaWxlQnJvd3NlckRpcmVjdGl2ZSgkbG9jYXRpb246IGFuZ3VsYXIuSUxvY2F0aW9uU2VydmljZSwgJHRpbWVvdXQ6IGFuZ3VsYXIuSVRpbWVvdXRTZXJ2aWNlLCBmaWxlU2VydmljZTogRmlsZVNlcnZpY2UpOiBhbmd1bGFyLklEaXJlY3RpdmUge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVcIixcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiaW5kZXgudHBsLmh0bWxcIixcclxuICAgICAgICAgICAgbGluaygkc2NvcGU6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3JlYXRlUmVhZGFibGVQYXRoID0gKHBhdGgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IHBhdGgucmVwbGFjZShcIi9yb290L1wiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYCR7cy5zbGljZSgwLCAxKS50b1VwcGVyQ2FzZSgpfToke3Muc2xpY2UoMSl9YC5yZXBsYWNlKC9cXC8vZywgXCJcXFxcXCIpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJG9uKFwiJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1vdmVVcCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jID0gJGxvY2F0aW9uLnBhdGgoKS5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHR3byBsYXN0IGNoYXJhY3RlcnMgZnJvbSBwYXRoLlxyXG4gICAgICAgICAgICAgICAgICAgIGxvYy5wb3AoKTsgbG9jLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKGxvYy5qb2luKFwiL1wiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHNldEVycm9yID0gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yID0gZTtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dCgoKSA9PiAkc2NvcGUuZXJyb3IgPSBudWxsLCAyMDAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gJGxvY2F0aW9uLnBhdGgoKSB8fCBcIi4vXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRpcmVjdG9yeUluZm8gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVTZXJ2aWNlLmdldERpcmVjdG9yeShwYXRoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5kaXJlY3RvcnkgPSBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlYWRhYmxlUGF0aCA9IGNyZWF0ZVJlYWRhYmxlUGF0aCgkc2NvcGUuZGlyZWN0b3J5LmZ1bGxQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCRzY29wZS5kaXJlY3RvcnkuZnVsbFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBzZXRFcnJvcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVTZXJ2aWNlLmdldERpcmVjdG9yeUluZm8ocGF0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oYSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlyZWN0b3J5SW5mbyA9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZXJyb3IgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBzZXRFcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZpbGVCcm93c2VyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbG9jYXRpb25cIiwgXCIkdGltZW91dFwiLCBcIkZpbGVTZXJ2aWNlXCJdO1xyXG59IiwiKG5nID0+IHtcclxuICAgIG5nLm1vZHVsZShcIm5hemFyaWkuZmlsZWJyb3dzZXJcIiwgW1wibmdSb3V0ZVwiLCBcImFuZ3VsYXItbG9hZGluZy1iYXJcIl0pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoXCJlbXB0eVwiLCAoKSA9PiB7IH0pXHJcbiAgICAgICAgLmRpcmVjdGl2ZShcIm5hemFyaWlGaWxlQnJvd3NlclwiLCBOYXphcmlpLkZpbGVCcm93c2VyLkRpcmVjdGl2ZXMuZmlsZUJyb3dzZXJEaXJlY3RpdmUpXHJcbiAgICAgICAgLnNlcnZpY2UoXCJGaWxlU2VydmljZVwiLCBOYXphcmlpLkZpbGVCcm93c2VyLlNlcnZpY2VzLkRlZmF1bHRGaWxlU2VydmljZSk7XHJcbn0pKGFuZ3VsYXIpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
